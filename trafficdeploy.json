{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "primaryId": {
            "type": "string",
            "metadata": {
                "description": "id of primary resource"
            }
        },
        "primaryPriority": {
            "type": "int",
            "metadata": {
                "description": "priority of primary resource"
            }
        },
        "secondaryId": {
            "type": "string",
            "metadata": {
                "description": "id of secondary resource"
            }
        },
        "secondaryPriority": {
            "type": "int",
            "metadata": {
                "description": "priority of secondary resource"
            }
        }
    },
    "functions": [],
    "variables": {
        "trafficManagerName": "trafficManagerProfile1"
    },
    "resources": [
     {
         "name": "[variables('trafficManagerName')]",
         "type": "Microsoft.Network/trafficManagerProfiles",
         "apiVersion": "2018-04-01",
         "tags": {
         },
         "location": "global",
         "properties": {
             "profileStatus": "Enabled",
             "trafficRoutingMethod": "Priority",
             "dnsConfig": {
                 "relativeName": "dnsConfig",
                 "ttl": 30
             },
             "monitorConfig": {
                 "protocol": "HTTP",
                 "port": 80,
                 "path": "path",
                 "intervalInSeconds": 30,
                 "timeoutInSeconds": 5,
                 "toleratedNumberOfFailures": 3
             }
         }
     },
     {
      "apiVersion": "2018-08-01",
      "type": "Microsoft.Network/trafficManagerProfiles/azureEndpoints",
      "dependsOn": [
        "[resourceId('Microsoft.Network/trafficManagerProfiles/',variables('trafficManagerName'))]"
      ],
      "location": "global",
      "name": "[concat(variables('trafficManagerName'),'/','primary')]",
      "properties": {
        "targetResourceId": "[resourceId('Microsoft.Resources/resourceGroups','rg-primary-app','Microsoft.Web/sites','fun-app-786')]",
        "endpointStatus": "Enabled",
        "priority": "[parameters('primaryPriority')]"
      }
     }
    //  {
    //   "apiVersion": "2018-08-01",
    //   "type": "Microsoft.Network/trafficManagerProfiles/azureEndpoints",
    //   "dependsOn": [
    //     "[resourceId('Microsoft.Network/trafficManagerProfiles/',variables('trafficManagerName'))]"
    //   ],
    //   "location": "global",
    //   "name": "[concat(variables('trafficManagerName'),'/','secondary')]",
    //   "properties": {
    //     "targetResourceId": "[parameters('secondaryId')]",
    //     "endpointStatus": "Enabled",
    //     "priority": "[parameters('secondaryPriority')]"
    //   }
    //  }
    ],
    "outputs": {
        "output1": {
            "type": "string",
            "value": "[parameters('primaryId')]"
        },
        "outpu2": {
            "type": "string",
            "value": "[parameters('secondaryId')]"
        }
    }
}
